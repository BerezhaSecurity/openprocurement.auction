<!DOCTYPE html>
<html lang="en" data-ng-app="app" ng-controller="AuctionController">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Auction Software</title>
    <!-- <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css"> -->
    <link rel="stylesheet" href="vendor/bootstrap/dist/css/bootstrap.min.css">
    <!-- Custom styles for this template -->
    <link href="static/css/starter-template.css" rel="stylesheet">

</head>
{% raw %}

<body>
    <div class="container">
        <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle collapsed" ng-init="navbarCollapsed=true" ng-click="navbarCollapsed = !navbarCollapsed">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="#">
                    <timer countdown="1" max-time-unit="second" interval="1000">{{countdown | number:0}} sec</timer>
                </a>
            </div>
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1" collapse="navbarCollapsed">

                <ul class="nav navbar-nav">
                    <li><a href="#">Info</a>
                    </li>
                    <li class="active"><a href="#">Bidding</a>
                    </li>
                    <li><a href="#">Settings</a>
                    </li>
                    <li><a ng-click="restart_changes()">Restart sync</a></li>
                    <div class="navbar-left">
                        <div class="btn-group btn-group-sm">
                            <button ng-repeat="item in auction_doc.initial_bids" type="button" ng-click="setuser(item.bidder_id)" class="btn btn-default navbar-btn">Login in as {{ item.label.en }}</button>
                            <button type="button" ng-click="setuser(null)" class="btn btn-default navbar-btn">Login in as viewer</button>
                        </div>
                    </div>
                </ul>
            </div>
            <!--/.nav-collapse -->
        </div>
        <timer countdown="1" interval="1000">
            <div class="progress progress-fixed-top">
                <div class="progress-bar progress-bar-striped active" role="progressbar" aria-valuenow="{{($parent.interval - countdown)/$parent.interval*100}}" aria-valuemin="0" aria-valuemax="100" style="width: {{($parent.interval - countdown)/$parent.interval*100}}%">
                </div>
            </div>
        </timer>
    </div>
    <div class="container-fluid auction-stages" ng-cloak>
        <div class="row">
            <div class="col-xs-3 hidden-xs">
                <strong>Time</strong>
            </div>
            <div class="col-xs-9 hidden-xs">
                <strong>Bidder</strong>
                <span class="pull-right">
                    <strong>Bid</strong>
                </span>
            </div>
        </div>
        <div class="row" >
            <div class="col-xs-4 round-element">
                Initial bids:
            </div>
        </div>
        <div class="row stage-element" ng-repeat="stage in auction_doc.initial_bids">
            <div class="col-xs-3 time-element">{{ stage.time|date : 'shortTime' }}</div>
            <div class="col-xs-9">
                <span ng-if="stage.bidder_id != bidder_id ">{{ stage.label.en }}</span>
                <span ng-if="stage.bidder_id == bidder_id ">You</span>
                <span ng-if="stage.amount" class="pull-right">{{ stage.amount }} {{ auction_doc.minimalStep.currency }}</span>
            </div>
        </div>
        <div ng-repeat="stage in auction_doc.stages">
            <div class="row" ng-if="stage['type'] == 'preliminary_bids'">
                <div class="col-xs-6 round-element">
                    Preliminary bids:
                </div>
            </div>
            <div class="row" ng-if="stage['type'] == 'announcement'">
                <div class="col-xs-6 round-element">
                    Announcement:
                </div>
            </div>
            <div class="row stage-element" ng-class="{true: 'current-stage', false: ''}[auction_doc.current_stage == $index]">
                <div class="col-xs-3 time-element">{{ stage.start|date : 'shortTime' }}</div>
                <div class="col-xs-9" ng-if="stage['type'] == 'preliminary_bids'">All bidders</div>
                <div class="col-xs-9" ng-if="stage['type'] == 'pause'">Pause</div>
                <div class="col-xs-9" ng-if="stage['type'] == 'announcement'">Results Release</div>
                <div class="col-xs-9" ng-if="stage['type'] == 'bids'">
                    <span ng-if="stage.bidder_id != bidder_id ">{{ stage.label.en }}</span>
                    <span ng-if="stage.bidder_id == bidder_id ">You</span>
                    <span class="pull-right">
                        <span ng-if="stage['type'] == 'bids'" ng-class="{true: 'text-muted', '': false}[auction_doc.current_stage < $index]">
                            <span ng-if="stage['changed']"><strong>{{ stage['amount'] }} <span ng-if="stage['amount']">{{ auction_doc.minimalStep.currency }}</span></strong></span>
                            <span ng-if="!stage['changed']">{{ stage['amount'] }}<span ng-if="stage['amount']">{{ auction_doc.minimalStep.currency }}</span></span>
                        </span>
                    </span>
                </div>
            </div>
            <div class="row" ng-if="stage['type'] == 'pause'">
                <div class="col-xs-4 round-element">
                    Round #{{ get_round_number($index) }}:
                </div>
            </div>
        </div>
    </div>
    <div class="container-fluid">
        <div ng-show="show_bids_form()" class="panel panel-default bg-warning fixed-bottom">
            <div class="panel-body bg-warning">
                <div class="row">
                    <div class="col-xs-12">
                        <alert ng-repeat="alert in alerts" type="{{alert.type}}" close="closeAlert(alert.msg_id)">{{alert.msg}}</alert>
                        <form id="BidsForm" name="BidsForm" class="form-inline" role="form">
                            <div class="input-group">
                                <input type="number" ng-disabled="!allow_bidding" class="form-control" id="bid" name="bid" ng-model="BidsForm.bid" placeholder="{{ max_bid_amount() }} or lower">
                                <div class="input-group-btn">
                                    <button type="submit" ng-show="allow_bidding" ng-click="post_bid()" class="btn btn-success">Place a bid</button>
                                    <button type="submit" ng-hide="allow_bidding" ng-click="edit_bid()" class="btn btn-link">Edit</button>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
                <div class="row">
                    <div class="col-xs-12">
                        <span class="pull-right"></span>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- /.container -->
</body>
{% endraw %}
<script type=text/javascript>
var db_url = '{{ db_url }}';
var auction_doc_id = '{{ auction_doc_id }}';
</script>
<!-- <script src="//ajax.googleapis.com/ajax/libs/angularjs/1.3.0/angular.min.js"></script> -->
<script src="vendor/angular/angular.min.js"></script>
<!-- <script src="//cdn.jsdelivr.net/pouchdb/3.0.6/pouchdb.min.js"></script> -->
<script src="vendor/pouchdb/dist/pouchdb.min.js"></script>
<script src="vendor/angular-translate/angular-translate.min.js"></script>
<script src="vendor/angular-bootstrap/ui-bootstrap-tpls.min.js"></script>
<script src="vendor/angular-timer/dist/angular-timer.min.js"></script>
<script src="static/js/app.js"></script>

</html>